<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seminario de Investigaci√≥n</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM CDNs (Deben cargarse primero) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Firebase CDNs (Versiones compat para acceso global) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <!-- Iconos simples con CSS -->
    <!-- Babel CDN (Para transpilar JSX en el navegador) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Firebase Configuration (load before main script) -->
    <script src="firebase-config.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #f9fafb;
            --bg-secondary: #ffffff;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
            --accent-color: #4D96FF;
            --success-color: #10b981;
            --error-color: #ef4444;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        [data-theme="dark"] {
            --bg-primary: #111827;
            --bg-secondary: #1f2937;
            --text-primary: #f9fafb;
            --text-secondary: #d1d5db;
            --border-color: #374151;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px 0 rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        .spinner {
            border: 4px solid rgba(77, 150, 255, 0.2);
            border-left-color: var(--accent-color);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes slideDown {
            from { opacity: 0; max-height: 0; }
            to { opacity: 1; max-height: 1000px; }
        }
        
        @keyframes slideUp {
            from { opacity: 1; max-height: 1000px; }
            to { opacity: 0; max-height: 0; }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .animate-slideDown { animation: slideDown 0.3s ease-out; }
        .animate-fadeIn { animation: fadeIn 0.5s ease-out; }
        .animate-pulse { animation: pulse 2s infinite; }
        
        .card {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }
        
        .progress-bar {
            background-color: var(--border-color);
            border-radius: 9999px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, var(--accent-color), var(--success-color));
            height: 100%;
            border-radius: 9999px;
            transition: width 0.5s ease;
        }
        
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        
        .badge-earned {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .badge-pending {
            background-color: rgba(107, 114, 128, 0.1);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }
        
        .input-field {
            background-color: var(--bg-secondary);
            border: 2px solid var(--border-color);
            color: var(--text-primary);
            transition: all 0.2s ease;
        }
        
        .input-field:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(77, 150, 255, 0.1);
        }
        
        .input-field.error {
            border-color: var(--error-color);
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }
        
        .input-field.success {
            border-color: var(--success-color);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: 600;
            transition: all 0.2s ease;
            cursor: pointer;
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-color), #3b82f6);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-secondary {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
        }
        
        .btn-secondary:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }
        
        .theme-toggle {
            background-color: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 9999px;
            padding: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .theme-toggle:hover {
            border-color: var(--accent-color);
        }
        
        .toast {
            position: fixed;
            top: 1rem;
            right: 1rem;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            color: white;
            font-weight: 600;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }
        
        .toast-success { background-color: var(--success-color); }
        .toast-error { background-color: var(--error-color); }
        
        .chevron {
            transition: transform 0.3s ease;
            display: inline-block;
        }
        
        .chevron.rotate-90 {
            transform: rotate(90deg);
        }
        
        .prose table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background-color: var(--bg-secondary);
        }
        
        .prose th, .prose td {
            border: 1px solid var(--border-color);
            padding: 0.75rem;
            text-align: left;
        }
        
        .prose th {
            background-color: var(--bg-primary);
            font-weight: 600;
        }
        
        .prose ul.list-disc, .prose ul.list-circle {
            padding-left: 1.5rem;
        }
        
        .prose ul.list-circle li {
            list-style-type: circle;
        }
        
        @media (max-width: 768px) {
            .card {
                margin: 0.5rem;
                padding: 1rem;
            }
            
            .btn {
                padding: 0.5rem 1rem;
                font-size: 0.875rem;
            }
            
            .toast {
                left: 1rem;
                right: 1rem;
                top: auto;
                bottom: 1rem;
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <div id="root"></div>

    <!-- Todo el c√≥digo React y la l√≥gica de la aplicaci√≥n van aqu√≠, despu√©s de cargar todas las librer√≠as -->
    <script type="text/babel">
        // Las librer√≠as Firebase compat se acceden directamente desde el objeto global firebase
        
        // Sistema de notificaciones Toast
        const ToastContext = React.createContext();
        
        function ToastProvider({ children }) {
            const [toasts, setToasts] = React.useState([]);
            
            const showToast = (message, type = 'success') => {
                const id = Date.now();
                setToasts(prev => [...prev, { id, message, type }]);
                setTimeout(() => {
                    setToasts(prev => prev.filter(toast => toast.id !== id));
                }, 3000);
            };
            
            return React.createElement(ToastContext.Provider, { value: { showToast } }, [
                children,
                React.createElement('div', { key: 'toasts' }, 
                    toasts.map(toast => 
                        React.createElement('div', {
                            key: toast.id,
                            className: `toast toast-${toast.type}`
                        }, toast.message)
                    )
                )
            ]);
        }
        
        // Hook para usar toast
        const useToast = () => React.useContext(ToastContext);
        
        // Hook para tema oscuro/claro
        function useTheme() {
            const [theme, setTheme] = React.useState(() => 
                localStorage.getItem('theme') || 'light'
            );
            
            React.useEffect(() => {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
            }, [theme]);
            
            const toggleTheme = () => {
                setTheme(prev => prev === 'light' ? 'dark' : 'light');
            };
            
            return { theme, toggleTheme };
        }
        
        // Componente Toggle de Tema
        function ThemeToggle() {
            const { theme, toggleTheme } = useTheme();
            return React.createElement('button', {
                className: 'theme-toggle',
                onClick: toggleTheme,
                title: `Cambiar a tema ${theme === 'light' ? 'oscuro' : 'claro'}`
            }, theme === 'light' ? 'üåô' : '‚òÄÔ∏è');
        }
        
        // Iconos mejorados
        const Lock = ({ className = '' }) => React.createElement('span', { className }, 'üîí');
        const User = ({ className = '' }) => React.createElement('span', { className }, 'üë§');
        const LogOut = ({ className = '' }) => React.createElement('span', { className }, 'üö™');
        const Loader2 = ({ className = '' }) => React.createElement('div', { className: `spinner ${className}` });
        const ChevronRight = ({ className = '' }) => React.createElement('span', { className }, '‚ñ∂');
        const CheckCircle = ({ className = '' }) => React.createElement('span', { className }, '‚úÖ');
        const Award = ({ className = '' }) => React.createElement('span', { className }, 'üèÜ');
        const Eye = ({ className = '' }) => React.createElement('span', { className }, 'üëÅ');
        const EyeOff = ({ className = '' }) => React.createElement('span', { className }, 'üôà');

        // Contexto para el usuario y la base de datos
        const AuthContext = React.createContext(null);

        // Componente para el spinner de carga mejorado
        const LoadingSpinner = () => (
          <div className="flex justify-center items-center py-8 animate-fadeIn">
            <div className="spinner"></div>
            <p className="ml-3" style={{color: 'var(--text-secondary)'}}>Cargando...</p>
          </div>
        );
        
        // Componente de barra de progreso
        function ProgressBar({ current, total, className = '' }) {
            const percentage = Math.round((current / total) * 100);
            return React.createElement('div', { className: `w-full ${className}` }, [
                React.createElement('div', {
                    key: 'bar',
                    className: 'progress-bar h-3 mb-2'
                }, React.createElement('div', {
                    className: 'progress-fill',
                    style: { width: `${percentage}%` }
                })),
                React.createElement('div', {
                    key: 'text',
                    className: 'flex justify-between text-sm',
                    style: { color: 'var(--text-secondary)' }
                }, [
                    React.createElement('span', { key: 'progress' }, `${current} de ${total} semanas`),
                    React.createElement('span', { key: 'percent' }, `${percentage}%`)
                ])
            ]);
        }
        
        // Dashboard de badges con funcionalidad para otorgar badges
        function BadgesDashboard({ courseWeeks, userData, onEarnBadge }) {
            const earnedBadges = userData?.badgesEarned || [];
            const totalBadges = courseWeeks.length;
            
            return React.createElement('div', {
                className: 'card rounded-xl p-6 mb-6 animate-fadeIn'
            }, [
                React.createElement('h3', {
                    key: 'title',
                    className: 'text-xl font-bold mb-4 flex items-center gap-2'
                }, [React.createElement(Award), 'Tus Badges']),
                React.createElement(ProgressBar, {
                    key: 'progress',
                    current: earnedBadges.length,
                    total: totalBadges,
                    className: 'mb-4'
                }),
                React.createElement('div', {
                    key: 'badges',
                    className: 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3'
                }, courseWeeks.map((week, index) => {
                    const hasEarned = earnedBadges.includes(week.badge);
                    const canEarn = !hasEarned && (week.week === 1 || earnedBadges.includes(courseWeeks[index - 1]?.badge));
                    
                    return React.createElement('div', {
                        key: week.week,
                        className: `badge ${hasEarned ? 'badge-earned' : canEarn ? 'badge-pending cursor-pointer hover:scale-105' : 'badge-pending opacity-50'} justify-between transition-all`,
                        onClick: canEarn ? () => onEarnBadge(week.badge) : undefined,
                        title: canEarn ? 'Haz clic para obtener este badge' : hasEarned ? 'Badge obtenido' : 'Completa la semana anterior primero'
                    }, [
                        React.createElement('span', { key: 'text' }, week.badge),
                        hasEarned ? React.createElement(CheckCircle, { key: 'icon' }) : React.createElement('span', { key: 'week' }, `S${week.week}`)
                    ]);
                }))
            ]);
        }

        // Componente de campo de entrada mejorado
        function InputField({ label, type = 'text', value, onChange, required = false, placeholder, error, success }) {
            const [showPassword, setShowPassword] = React.useState(false);
            const inputType = type === 'password' && showPassword ? 'text' : type;
            
            return React.createElement('div', { className: 'mb-4' }, [
                React.createElement('label', {
                    key: 'label',
                    className: 'block text-sm font-bold mb-2',
                    style: { color: 'var(--text-primary)' }
                }, label),
                React.createElement('div', { key: 'input-container', className: 'relative' }, [
                    React.createElement('input', {
                        key: 'input',
                        className: `input-field w-full py-3 px-4 rounded-lg focus:outline-none ${error ? 'error' : success ? 'success' : ''}`,
                        type: inputType,
                        placeholder,
                        value,
                        onChange,
                        required
                    }),
                    type === 'password' && React.createElement('button', {
                        key: 'toggle',
                        type: 'button',
                        className: 'absolute right-3 top-1/2 transform -translate-y-1/2 text-lg',
                        onClick: () => setShowPassword(!showPassword)
                    }, showPassword ? React.createElement(EyeOff) : React.createElement(Eye))
                ]),
                error && React.createElement('p', {
                    key: 'error',
                    className: 'text-sm mt-1',
                    style: { color: 'var(--error-color)' }
                }, error)
            ]);
        }
        
        // Componente de Autenticaci√≥n mejorado
        function AuthPage({ firebaseApp }) {
            const toast = useToast();
            const auth = firebase.auth();
            const db = firebase.firestore();
            const [isLogin, setIsLogin] = React.useState(true);
            const [email, setEmail] = React.useState('');
            const [password, setPassword] = React.useState('');
            const [fullName, setFullName] = React.useState('');
            const [errors, setErrors] = React.useState({});
            const [loading, setLoading] = React.useState(false);
            
            const validateEmail = (email) => {
                const studentPattern = /^[a-zA-Z0-9._%+-]+@icesi\.edu\.co$/;
                const professorPattern = /^[a-zA-Z0-9._%+-]+@u\.icesi\.edu\.co$/;
                return studentPattern.test(email) || professorPattern.test(email);
            };

            const isProfessor = (email) => {
                return email.endsWith('@u.icesi.edu.co');
            };
            
            const validateField = (name, value) => {
                const newErrors = { ...errors };
                
                switch (name) {
                    case 'email':
                        if (!value) newErrors.email = 'El correo es requerido';
                        else if (!validateEmail(value)) newErrors.email = 'Usa tu correo institucional (@icesi.edu.co o @u.icesi.edu.co)';
                        else delete newErrors.email;
                        break;
                    case 'password':
                        if (!value) newErrors.password = 'La contrase√±a es requerida';
                        else if (value.length < 6) newErrors.password = 'M√≠nimo 6 caracteres';
                        else delete newErrors.password;
                        break;
                    case 'fullName':
                        if (!isLogin && !value) newErrors.fullName = 'El nombre es requerido';
                        else delete newErrors.fullName;
                        break;
                }
                
                setErrors(newErrors);
                return Object.keys(newErrors).length === 0;
            };

            const handleAuth = async (e) => {
                e.preventDefault();
                setLoading(true);

                if (!validateEmail(email)) {
                    toast.showToast('Usa tu correo institucional', 'error');
                    setLoading(false);
                    return;
                }

                try {
                    console.log('Intentando autenticaci√≥n...', isLogin ? 'Login' : 'Registro');
                    if (isLogin) {
                        const result = await auth.signInWithEmailAndPassword(email, password);
                        console.log('Login exitoso:', result.user.uid);
                    } else {
                        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                        const user = userCredential.user;
                        console.log('Registro exitoso:', user.uid);
                        
                        const appId = 'seminario-investigacion-app'; 
                        const userDocRef = db.doc(`artifacts/${appId}/users/${user.uid}`);
                        
                        const userData = {
                            email: email,
                            fullName: fullName,
                            userType: isProfessor(email) ? 'professor' : 'student',
                            createdAt: new Date()
                        };

                        if (!isProfessor(email)) {
                            userData.badgesEarned = [];
                            userData.lastBadgeEarned = null;
                        }
                        
                        await userDocRef.set(userData);
                        console.log('Datos de usuario guardados en Firestore');
                    }
                    console.log('Autenticaci√≥n completada exitosamente');
                    toast.showToast(
                        isLogin ? '¬°Bienvenido de vuelta!' : '¬°Cuenta creada exitosamente!',
                        'success'
                    );
                    setErrors({});
                } catch (err) {
                    console.error("Error de autenticaci√≥n:", err.code, err.message);
                    let errorMessage;
                    switch (err.code) {
                        case 'auth/invalid-email':
                            errorMessage = 'El correo electr√≥nico no tiene un formato v√°lido.';
                            break;
                        case 'auth/user-disabled':
                            errorMessage = 'Tu cuenta ha sido deshabilitada.';
                            break;
                        case 'auth/user-not-found':
                            errorMessage = 'Usuario no encontrado. Verifica tu correo o crea una cuenta.';
                            break;
                        case 'auth/wrong-password':
                            errorMessage = 'Contrase√±a incorrecta.';
                            break;
                        case 'auth/email-already-in-use':
                            errorMessage = 'Este correo ya est√° registrado.';
                            break;
                        case 'auth/weak-password':
                            errorMessage = 'La contrase√±a es demasiado d√©bil. Debe tener al menos 6 caracteres.';
                            break;
                        default:
                            errorMessage = 'Error de autenticaci√≥n. Por favor, intenta de nuevo.';
                    }
                    toast.showToast(errorMessage, 'error');
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="min-h-screen flex items-center justify-center p-4" style={{backgroundColor: 'var(--bg-primary)'}}>
                    <div className="card rounded-2xl p-8 w-full max-w-md animate-fadeIn">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-3xl font-bold" style={{color: 'var(--text-primary)'}}>
                                {isLogin ? 'Iniciar Sesi√≥n' : 'Crear Cuenta'}
                            </h2>
                            <ThemeToggle />
                        </div>
                        
                        <form onSubmit={handleAuth}>
                            <InputField
                                label="Correo Institucional"
                                type="email"
                                placeholder="correo@icesi.edu.co"
                                value={email}
                                onChange={(e) => {
                                    setEmail(e.target.value);
                                    validateField('email', e.target.value);
                                }}
                                error={errors.email}
                                success={email && !errors.email}
                                required
                            />
                            
                            {!isLogin && (
                                <InputField
                                    label="Nombre Completo"
                                    placeholder="Tu Nombre Completo"
                                    value={fullName}
                                    onChange={(e) => {
                                        setFullName(e.target.value);
                                        validateField('fullName', e.target.value);
                                    }}
                                    error={errors.fullName}
                                    success={fullName && !errors.fullName}
                                    required={!isLogin}
                                />
                            )}
                            
                            <InputField
                                label="Contrase√±a"
                                type="password"
                                placeholder="M√≠nimo 6 caracteres"
                                value={password}
                                onChange={(e) => {
                                    setPassword(e.target.value);
                                    validateField('password', e.target.value);
                                }}
                                error={errors.password}
                                success={password && !errors.password}
                                required
                            />
                            
                            <div className="flex flex-col gap-4 mt-6">
                                <button
                                    className="btn btn-primary w-full"
                                    type="submit"
                                    disabled={loading || Object.keys(errors).length > 0}
                                >
                                    {loading && <Loader2 className="w-5 h-5" />}
                                    {isLogin ? 'Iniciar Sesi√≥n' : 'Registrarse'}
                                </button>
                                
                                <button
                                    className="btn btn-secondary w-full"
                                    type="button"
                                    onClick={() => {
                                        setIsLogin(!isLogin);
                                        setErrors({});
                                        setStudentCode('');
                                        setPassword('');
                                        setFullName('');
                                    }}
                                >
                                    {isLogin ? '¬øNo tienes cuenta? Reg√≠strate' : '¬øYa tienes cuenta? Inicia Sesi√≥n'}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        // Componente de Tarjeta de Semana del Curso mejorado
        function CourseWeek({ weekNumber, title, content, badgeName, isUnlocked, hasBadge }) {
            const [isExpanded, setIsExpanded] = React.useState(false);

            return (
                <div className={`card rounded-xl p-6 mb-6 animate-fadeIn transition-all duration-300 ${
                    isUnlocked ? 'border-l-4' : 'border-l-4 opacity-75'
                }`} style={{
                    borderLeftColor: isUnlocked ? 'var(--accent-color)' : 'var(--border-color)'
                }}>
                    <div className="mb-4">
                        <h3 className="text-xl font-bold mb-3" style={{color: 'var(--text-primary)'}}>
                            Semana {weekNumber}: {title}
                        </h3>
                        <div className="flex justify-between items-center">
                            <span className={`badge ${
                                hasBadge ? 'badge-earned' : 'badge-pending'
                            } flex items-center gap-2`}>
                                {hasBadge ? <CheckCircle /> : <Award />}
                                {hasBadge ? 'Badge Obtenido' : badgeName}
                            </span>
                            {isUnlocked ? (
                                <button
                                    onClick={() => setIsExpanded(!isExpanded)}
                                    className="btn-secondary p-3 rounded-full transition-all duration-200 hover:scale-105"
                                    aria-expanded={isExpanded}
                                    aria-controls={`week-content-${weekNumber}`}
                                    title={isExpanded ? 'Contraer contenido' : 'Expandir contenido'}
                                >
                                    <span className={`chevron ${isExpanded ? 'rotate-90' : ''}`}>‚ñ∂</span>
                                </button>
                            ) : (
                                <div className="p-3 rounded-full" style={{backgroundColor: 'var(--bg-primary)'}}>
                                    <Lock className="opacity-50" />
                                </div>
                            )}
                        </div>
                    </div>
                    
                    {!isUnlocked && (
                        <div className="flex items-center gap-2 p-4 rounded-lg" style={{
                            backgroundColor: 'var(--bg-primary)',
                            color: 'var(--text-secondary)'
                        }}>
                            <Lock />
                            <p className="italic">
                                Contenido bloqueado. Necesitas el badge de la semana anterior para desbloquear.
                            </p>
                        </div>
                    )}
                    
                    {isUnlocked && isExpanded && (
                        <div 
                            id={`week-content-${weekNumber}`} 
                            className="mt-6 prose max-w-none animate-slideDown"
                            style={{color: 'var(--text-primary)'}}
                        >
                            {content}
                        </div>
                    )}
                </div>
            );
        }

        // Componente de administraci√≥n para profesores
        function AdminDashboard({ currentUser }) {
            const auth = firebase.auth();
            const db = firebase.firestore();
            const toast = useToast();
            const [students, setStudents] = React.useState([]);
            const [userData, setUserData] = React.useState(null);
            const [loading, setLoading] = React.useState(true);
            const appId = 'seminario-investigacion-app';

            React.useEffect(() => {
                loadUserData();
                loadStudents();
            }, []);

            const loadUserData = async () => {
                try {
                    const userDoc = await db.doc(`artifacts/${appId}/users/${currentUser.uid}`).get();
                    if (userDoc.exists) {
                        setUserData(userDoc.data());
                    }
                } catch (error) {
                    console.error('Error cargando datos del profesor:', error);
                }
            };

            const loadStudents = async () => {
                try {
                    const snapshot = await db.collection('artifacts').doc(appId)
                        .collection('users')
                        .where('userType', '==', 'student')
                        .get();
                    
                    const studentsData = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    
                    setStudents(studentsData);
                } catch (error) {
                    console.error('Error cargando estudiantes:', error);
                    toast.showToast('Error cargando estudiantes', 'error');
                } finally {
                    setLoading(false);
                }
            };

            const assignBadge = async (studentId, badgeName) => {
                try {
                    const student = students.find(s => s.id === studentId);
                    if (!student) return;

                    const updatedBadges = [...(student.badgesEarned || []), badgeName];
                    
                    await db.doc(`artifacts/${appId}/users/${studentId}`).update({
                        badgesEarned: updatedBadges,
                        lastBadgeEarned: new Date()
                    });
                    
                    setStudents(prev => prev.map(s => 
                        s.id === studentId 
                            ? { ...s, badgesEarned: updatedBadges }
                            : s
                    ));
                    
                    toast.showToast(`Badge "${badgeName}" asignado a ${student.fullName}`, 'success');
                } catch (error) {
                    console.error('Error asignando badge:', error);
                    toast.showToast('Error asignando badge', 'error');
                }
            };

            const handleLogout = async () => {
                try {
                    await auth.signOut();
                    toast.showToast('¬°Hasta luego!', 'success');
                } catch (err) {
                    console.error("Error al cerrar sesi√≥n:", err);
                    toast.showToast("Error al cerrar sesi√≥n. Intenta de nuevo.", 'error');
                }
            };

            const courseWeeks = [
                { week: 1, badge: 'Badge de Iniciaci√≥n' },
                { week: 2, badge: 'Badge de Br√∫jula √âtica' },
                { week: 3, badge: 'Badge de Sembrador de Ideas' },
                { week: 4, badge: 'Badge de Art√≠fice de Preguntas' },
                { week: 5, badge: 'Badge de Bibliotecario Experto' },
                { week: 6, badge: 'Badge de Arquitecto de Proyectos' },
                { week: 7, badge: 'Badge de Navegante Experto' },
                { week: 8, badge: 'Badge de Estratega Metodol√≥gico' },
                { week: 9, badge: 'Badge de Constructor de Instrumentos' },
                { week: 10, badge: 'Badge de Recolector de Datos' },
                { week: 11, badge: 'Badge de Int√©rprete Cualitativo' },
                { week: 12, badge: 'Badge de Analista Cuantitativo' },
                { week: 13, badge: 'Badge de Descubridor de Patrones' },
                { week: 14, badge: 'Badge de Narrador Visual' },
                { week: 15, badge: 'Badge de Comunicador Maestro' },
                { week: 16, badge: 'Badge de Investigador √âlite' }
            ];

            return React.createElement('div', { className: 'min-h-screen p-4 md:p-8', style: { backgroundColor: 'var(--bg-primary)' } }, [
                React.createElement('header', {
                    key: 'header',
                    className: 'card rounded-xl p-6 mb-8 animate-fadeIn'
                }, [
                    React.createElement('div', {
                        key: 'header-content',
                        className: 'flex flex-col md:flex-row justify-between items-start md:items-center gap-4'
                    }, [
                        React.createElement('div', { key: 'title-section' }, [
                            React.createElement('h1', { className: 'text-3xl font-bold mb-2' }, 'Panel de Administraci√≥n'),
                            React.createElement('p', { 
                                className: 'text-sm',
                                style: { color: 'var(--text-secondary)' }
                            }, `Profesor: ${userData?.fullName || currentUser.email}`)
                        ]),
                        React.createElement('div', { key: 'actions', className: 'flex items-center gap-3' }, [
                            React.createElement(ThemeToggle, { key: 'theme' }),
                            React.createElement('button', {
                                key: 'logout',
                                onClick: handleLogout,
                                className: 'btn btn-secondary flex items-center gap-2'
                            }, [React.createElement(LogOut), 'Cerrar Sesi√≥n'])
                        ])
                    ])
                ]),
                loading ? React.createElement(LoadingSpinner, { key: 'loading' }) :
                React.createElement('div', { key: 'content', className: 'card rounded-xl p-6' }, [
                    React.createElement('h2', {
                        key: 'students-title',
                        className: 'text-xl font-bold mb-4'
                    }, `Estudiantes Registrados (${students.length})`),
                    React.createElement('div', {
                        key: 'students-list',
                        className: 'space-y-4'
                    }, students.map(student => 
                        React.createElement('div', {
                            key: student.id,
                            className: 'border rounded-lg p-4',
                            style: { borderColor: 'var(--border-color)' }
                        }, [
                            React.createElement('div', {
                                key: 'info',
                                className: 'flex justify-between items-start mb-3'
                            }, [
                                React.createElement('div', { key: 'details' }, [
                                    React.createElement('h3', { className: 'font-semibold' }, student.fullName),
                                    React.createElement('p', {
                                        className: 'text-sm',
                                        style: { color: 'var(--text-secondary)' }
                                    }, student.email)
                                ]),
                                React.createElement('div', {
                                    key: 'progress',
                                    className: 'text-right'
                                }, [
                                    React.createElement('p', { className: 'text-sm font-medium' }, 
                                        `${(student.badgesEarned || []).length}/${courseWeeks.length} badges`
                                    )
                                ])
                            ]),
                            React.createElement('div', {
                                key: 'badges',
                                className: 'grid grid-cols-2 md:grid-cols-4 gap-2'
                            }, courseWeeks.map(week => {
                                const hasEarned = (student.badgesEarned || []).includes(week.badge);
                                const canAssign = !hasEarned;
                                
                                return React.createElement('button', {
                                    key: week.week,
                                    onClick: canAssign ? () => assignBadge(student.id, week.badge) : undefined,
                                    disabled: hasEarned,
                                    className: `text-xs p-2 rounded transition-all ${
                                        hasEarned 
                                            ? 'bg-green-100 text-green-800 cursor-default' 
                                            : 'bg-gray-100 hover:bg-blue-100 text-gray-700 hover:text-blue-800 cursor-pointer'
                                    }`
                                }, [
                                    React.createElement('div', { className: 'font-medium' }, `S${week.week}`),
                                    React.createElement('div', { className: 'truncate' }, week.badge),
                                    hasEarned && React.createElement(CheckCircle, { className: 'inline ml-1' })
                                ]);
                            }))
                        ])
                    ))
                ])
            ]);
        }

        // Componente de la P√°gina del Curso Principal mejorado
        function CoursePage({ firebaseApp, currentUser }) {
            const auth = firebase.auth();
            const db = firebase.firestore();
            const toast = useToast();
            const [userData, setUserData] = React.useState(null);
            const [loadingUserData, setLoadingUserData] = React.useState(true);
            const [error, setError] = React.useState('');

            // Usamos un appId fijo para GitHub Pages
            const appId = 'seminario-investigacion-app'; 

            React.useEffect(() => {
                if (!currentUser) {
                    setLoadingUserData(false);
                    return;
                }

                // Verificar si es profesor y redirigir
                const checkUserType = async () => {
                    try {
                        const userDoc = await db.doc(`artifacts/${appId}/users/${currentUser.uid}`).get();
                        if (userDoc.exists && userDoc.data().userType === 'professor') {
                            // No cargar datos de estudiante para profesores
                            setLoadingUserData(false);
                            return;
                        }
                    } catch (error) {
                        console.error('Error verificando tipo de usuario:', error);
                    }
                };

                checkUserType();

                // Crear datos por defecto si no se pueden cargar desde Firestore
                const defaultUserData = {
                    email: currentUser.email,
                    fullName: currentUser.email.split('@')[0],
                    badgesEarned: [] // Sin badges inicialmente
                };
                
                const userDocRef = db.doc(`artifacts/${appId}/users/${currentUser.uid}`);
                const unsubscribe = userDocRef.onSnapshot((docSnap) => {
                    if (docSnap.exists) {
                        const data = docSnap.data();
                        if (data.userType === 'professor') {
                            setLoadingUserData(false);
                            return;
                        }
                        setUserData(data);
                        setError('');
                    } else {
                        console.warn("No se encontr√≥ el documento del usuario en Firestore. Usando datos por defecto.");
                        setUserData(defaultUserData);
                        setError('');
                    }
                    setLoadingUserData(false);
                }, (err) => {
                    console.error("Error al obtener datos del usuario:", err);
                    console.log("Usando datos por defecto debido a error de permisos");
                    setUserData(defaultUserData);
                    setError('');
                    setLoadingUserData(false);
                });

                return () => unsubscribe(); // Limpiar el listener al desmontar
            }, [currentUser, db, appId]);

            const handleLogout = async () => {
                try {
                    await auth.signOut();
                    toast.showToast('¬°Hasta luego!', 'success');
                } catch (err) {
                    console.error("Error al cerrar sesi√≥n:", err);
                    toast.showToast("Error al cerrar sesi√≥n. Intenta de nuevo.", 'error');
                }
            };

            const hasBadge = (badgeName) => userData?.badgesEarned?.includes(badgeName) || false;
            
            // Funci√≥n para otorgar un badge
            const earnBadge = async (badgeName) => {
                if (hasBadge(badgeName)) {
                    toast.showToast('Ya tienes este badge', 'error');
                    return;
                }
                
                try {
                    const userDocRef = db.doc(`artifacts/${appId}/users/${currentUser.uid}`);
                    const currentBadges = userData?.badgesEarned || [];
                    const newBadges = [...currentBadges, badgeName];
                    
                    await userDocRef.update({
                        badgesEarned: newBadges,
                        lastBadgeEarned: new Date()
                    });
                    
                    toast.showToast(`¬°Felicidades! Has obtenido: ${badgeName}`, 'success');
                } catch (error) {
                    console.error('Error al otorgar badge:', error);
                    toast.showToast('Error al otorgar el badge', 'error');
                }
            };

            const courseWeeks = [
                {
                    week: 1,
                    title: 'Misi√≥n de Inicio - Descubriendo el Territorio de la Investigaci√≥n',
                    badge: 'Badge de Iniciaci√≥n',
                    content: (
                        <>
                            <div className="mb-6">
                                <h4 className="font-bold text-lg mb-3" style={{color: 'var(--accent-color)'}}>üìö Contenido</h4>
                                <ul className="list-disc list-inside ml-4 space-y-2">
                                    <li>Presentaci√≥n del curso: objetivos, metodolog√≠a (te√≥rico-pr√°ctica, gamificada), sistema de "badges" y evaluaci√≥n.</li>
                                    <li>Acuerdos sobre el uso √©tico, cr√≠tico y transparente de la Inteligencia Artificial Generativa (IAG) en el curso.</li>
                                    <li>Introducci√≥n a la investigaci√≥n aplicada en dise√±o, innovaci√≥n y experiencia de usuario: ¬øPor qu√© investigamos en dise√±o?</li>
                                    <li>Identificaci√≥n de los diferentes campos y tipos de investigaci√≥n desde la disciplina del dise√±o (investigaci√≥n para el dise√±o, a trav√©s del dise√±o, sobre el dise√±o).</li>
                                </ul>
                            </div>
                            <div className="mb-6">
                                <h4 className="font-bold text-lg mb-3" style={{color: 'var(--accent-color)'}}>üéØ Actividad en Clase (2 horas)</h4>
                                <ul className="list-disc list-inside ml-4 space-y-3">
                                    <li><strong>"C√≠rculo de Expectativas" (15 min):</strong> Cada estudiante comparte qu√© espera del curso y qu√© le gustar√≠a investigar.</li>
                                    <li><strong>"Exploraci√≥n de Casos Inspiradores" (60 min):</strong> An√°lisis grupal de 2-3 proyectos de investigaci√≥n en dise√±o (ej. estudios de usabilidad, investigaci√≥n de mercado para un nuevo producto, dise√±o participativo). Discusi√≥n guiada: ¬øQu√© problema abordaron? ¬øQu√© m√©todos usaron? ¬øCu√°l fue su impacto?</li>
                                    <li><strong>"Debate: El Poder de la Pregunta" (30 min):</strong> Discusi√≥n sobre la importancia de una buena pregunta de investigaci√≥n como punto de partida.</li>
                                    <li><strong>Sesi√≥n de Preguntas y Respuestas (15 min):</strong> Aclaraci√≥n de dudas sobre el s√≠labo y la din√°mica del curso.</li>
                                </ul>
                            </div>
                            <div className="mb-6">
                                <h4 className="font-bold text-lg mb-3" style={{color: 'var(--accent-color)'}}>üìù Tarea (Desaf√≠o Post-Clase)</h4>
                                <ul className="list-disc list-inside ml-4 space-y-3">
                                    <li><strong>"Primer Paso del Explorador":</strong> Leer la introducci√≥n del libro "Metodolog√≠a de la Investigaci√≥n" de Sampieri (Cap√≠tulo 1: La idea de investigaci√≥n y el planteamiento del problema).</li>
                                    <li><strong>"Diario del Investigador":</strong> Reflexionar y escribir en un documento personal (o digital) 3 preguntas iniciales que te gustar√≠a responder a trav√©s de la investigaci√≥n en dise√±o, bas√°ndote en tus intereses personales o profesionales.</li>
                                </ul>
                            </div>
                        </>
                    ),
                    isUnlockable: true // Siempre desbloqueada la primera semana
                },
                {
                    week: 2,
                    title: 'Misi√≥n de Enfoque - Br√∫julas Metodol√≥gicas y √âtica del Explorador',
                    badge: 'Badge de Br√∫jula √âtica',
                    content: (
                        <>
                            <div className="mb-6">
                                <h4 className="font-bold text-lg mb-3" style={{color: 'var(--accent-color)'}}>üìö Contenido</h4>
                                <ul className="list-disc list-inside ml-4 space-y-2">
                                    <li><strong>Enfoques de la investigaci√≥n:</strong> Cuantitativo (medici√≥n, estad√≠sticas), Cualitativo (comprensi√≥n profunda, narrativas) y Mixto (combinaci√≥n de ambos).</li>
                                    <li><strong>Rutas metodol√≥gicas:</strong> Dise√±o de experimentos, estudios de caso, encuestas, etnograf√≠a, etc.</li>
                                    <li><strong>Principios √©ticos:</strong> Consentimiento informado, privacidad, anonimato, no maleficencia, justicia.</li>
                                </ul>
                            </div>
                            <div className="mb-6">
                                <h4 className="font-bold text-lg mb-3" style={{color: 'var(--accent-color)'}}>üéØ Actividad en Clase (2 horas)</h4>
                                <ul className="list-disc list-inside ml-4 space-y-3">
                                    <li><strong>"Diferenciando Rutas: Taller de Casos" (75 min):</strong> Los estudiantes, en peque√±os grupos, analizar√°n 3-4 res√∫menes de investigaciones (se proporcionar√°n). Deber√°n identificar el enfoque principal (cualitativo, cuantitativo, mixto), justificar su elecci√≥n y proponer una posible ruta metodol√≥gica. Presentaci√≥n y debate grupal.</li>
                                    <li><strong>"El Dilema √âtico: Discusi√≥n Abierta" (45 min):</strong> Presentaci√≥n de 2-3 escenarios hipot√©ticos de investigaci√≥n en dise√±o con dilemas √©ticos. Los estudiantes discutir√°n en grupos c√≥mo abordar√≠an cada situaci√≥n de manera √©tica, aplicando los principios aprendidos.</li>
                                </ul>
                            </div>
                            <div className="mb-6">
                                <h4 className="font-bold text-lg mb-3" style={{color: 'var(--accent-color)'}}>üìù Tarea (Desaf√≠o Post-Clase)</h4>
                                <ul className="list-disc list-inside ml-4 space-y-3">
                                    <li><strong>"An√°lisis de Br√∫julas":</strong> Leer un art√≠culo de investigaci√≥n cualitativa y uno cuantitativa en dise√±o (enlaces proporcionados). Para cada uno, identificar:
                                        <ul className="list-circle list-inside ml-6 mt-2 space-y-1">
                                            <li>El enfoque principal y por qu√© lo clasificas as√≠</li>
                                            <li>El tipo de datos recolectados</li>
                                            <li>C√≥mo se abord√≥ (o deber√≠a haberse abordado) la √©tica en el estudio</li>
                                        </ul>
                                    </li>
                                </ul>
                            </div>
                        </>
                    ),
                    isUnlockable: false // Se desbloquea con el badge anterior
                },
                {
                    week: 3,
                    title: 'Misi√≥n de Ideaci√≥n - Sembrando Ideas, Cosechando Problemas',
                    badge: 'Badge de Sembrador de Ideas',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>C√≥mo surgen las ideas de investigaci√≥n en el campo del dise√±o e innovaci√≥n: observaci√≥n, tendencias, necesidades no satisfechas, brechas en el conocimiento.</li>
                                <li>T√©cnicas de problematizaci√≥n: "5 Porqu√©s", Diagrama de Ishikawa (causa-efecto), √Årbol de Problemas.</li>
                                <li>Exploraci√≥n de problem√°ticas relevantes en el contexto actual del dise√±o y la sociedad.</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"Tormenta de Ideas Creativa y Problem√°tica" (60 min):** Los estudiantes, de forma individual o en parejas, usar√°n la herramienta de **"Generador de Ideas de Investigaci√≥n ‚ú®"** en la infograf√≠a del curso. Cada uno describir√° 2-3 intereses amplios (ej. "sostenibilidad en moda", "gamificaci√≥n en educaci√≥n", "interfaz para personas mayores"). Luego, la IA generar√° ideas.</li>
                                <li>**"Taller: Descomponiendo el Problema" (60 min):** Elegir√°n una de las ideas generadas (o una propia) y aplicar√°n la t√©cnica de los "5 Porqu√©s" o el Diagrama de Ishikawa para profundizar en la ra√≠z del problema.</li>
                            </ul>
                            <p className="font-semibold mt-4">Tarea (Desaf√≠o Post-Clase):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Problema del H√©roe":** Seleccionar la problem√°tica que m√°s les interese para su proyecto. Realizar una b√∫squeda preliminar de informaci√≥n (noticias, blogs, informes, redes sociales) para entender el contexto, los actores involucrados y lo que ya se sabe sobre el problema.</li>
                                <li>**"Mapa Mental del Problema":** Crear un mapa mental visual de la problem√°tica elegida, incluyendo causas, efectos, actores y posibles √°reas de intervenci√≥n desde el dise√±o.</li>
                            </ul>
                        </>
                    ),
                    isUnlockable: false
                },
                {
                    week: 4,
                    title: 'Misi√≥n de Precisi√≥n - Afinando la Pregunta Correcta',
                    badge: 'Badge de Art√≠fice de Preguntas',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>An√°lisis de problemas en diversos contextos: identificaci√≥n de la poblaci√≥n, el contexto y el alcance.</li>
                                <li>Delimitaci√≥n de problemas de investigaci√≥n: de lo general a lo espec√≠fico.</li>
                                <li>Formulaci√≥n de preguntas de investigaci√≥n: caracter√≠sticas de una buena pregunta (clara, concisa, factible, relevante, √©tica). Tipos de preguntas (descriptivas, exploratorias, explicativas, predictivas).</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"Taller de Preguntas Poderosas" (90 min):** Bas√°ndose en su problem√°tica definida, los estudiantes trabajar√°n en la formulaci√≥n de al menos 3 preguntas de investigaci√≥n tentativas. Se utilizar√° la t√©cnica PICO (Poblaci√≥n, Intervenci√≥n/Exposici√≥n, Comparaci√≥n, Outcome) o PECOT (Poblaci√≥n, Exposici√≥n, Comparaci√≥n, Outcome, Tiempo) como gu√≠a. Habr√° rondas de retroalimentaci√≥n entre pares y con el profesor para refinar las preguntas.</li>
                                <li>**"El Embudo de la Investigaci√≥n" (30 min):** Ejercicio pr√°ctico para pasar de una idea general a una pregunta de investigaci√≥n muy espec√≠fica, enfatizando la delimitaci√≥n.</li>
                            </ul>
                            <p className="font-semibold mt-4">Tarea (Desaf√≠o Post-Clase):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Enigma Resuelto":** Redactar el planteamiento del problema (descripci√≥n, contexto, justificaci√≥n de su relevancia) y la pregunta de investigaci√≥n final para su proyecto. Esta pregunta debe ser el eje central de su futura investigaci√≥n.</li>
                            </ul>
                        </>
                    ),
                    isUnlockable: false
                },
                {
                    week: 5,
                    title: 'Misi√≥n de Fundamentaci√≥n - Construyendo los Pilares del Conocimiento',
                    badge: 'Badge de Bibliotecario Experto',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>Revisi√≥n de literatura cient√≠fica: importancia, tipos de fuentes (art√≠culos, libros, tesis), bases de datos acad√©micas (Scopus, Google Scholar, Dialnet, etc.).</li>
                                <li>Estrategias de b√∫squeda sistem√°tica: palabras clave, operadores booleanos, filtros.</li>
                                <li>Gesti√≥n de referencias bibliogr√°ficas (Mendeley, Zotero, etc. - menci√≥n de herramientas).</li>
                                <li>Formulaci√≥n de objetivos de investigaci√≥n: objetivos generales (qu√© se busca lograr) y espec√≠ficos (pasos para lograr el general). Caracter√≠sticas SMART.</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"Cazadores de Conocimiento: Laboratorio de B√∫squeda" (75 min):** Los estudiantes, con sus laptops, realizar√°n b√∫squedas de literatura en bases de datos acad√©micas relevantes para sus temas. El profesor guiar√° en el uso de operadores y filtros avanzados.</li>
                                <li>**"Objetivos SMART: Taller de Precisi√≥n" (45 min):** Los estudiantes redactar√°n sus objetivos generales y espec√≠ficos, asegur√°ndose de que sean SMART y est√©n directamente alineados con su pregunta de investigaci√≥n. Retroalimentaci√≥n en peque√±os grupos.</li>
                            </ul>
                            <p className="font-semibold mt-4">Tarea (Desaf√≠o Post-Clase):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"La Biblioteca del Investigador":** Realizar una revisi√≥n bibliogr√°fica profunda. Identificar y leer al menos 5-7 fuentes clave (art√≠culos de investigaci√≥n, cap√≠tulos de libros) directamente relacionadas con su problem√°tica y pregunta.</li>
                                <li>**"Marco Conceptual Preliminar":** Comenzar a identificar y definir los conceptos clave que emergen de su revisi√≥n bibliogr√°fica y que ser√°n fundamentales para su investigaci√≥n.</li>
                            </ul>
                        </>
                    ),
                    isUnlockable: false
                },
                {
                    week: 6,
                    title: 'Misi√≥n de Planificaci√≥n - El Mapa del Tesoro de tu Proyecto',
                    badge: 'Badge de Arquitecto de Proyectos',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>Justificaci√≥n de la investigaci√≥n: ¬øPor qu√© es importante este estudio? Relevancia te√≥rica, pr√°ctica, social, metodol√≥gica.</li>
                                <li>Alcance y limitaciones del estudio: ¬øQu√© abarcar√° y qu√© no?</li>
                                <li>Estructura de la propuesta de investigaci√≥n: Introducci√≥n, planteamiento del problema, justificaci√≥n, objetivos, marco conceptual (preliminar), metodolog√≠a (esquema), cronograma (tentativo), presupuesto (tentativo), referencias.</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Argumento Persuasivo: Taller de Justificaci√≥n" (60 min):** Los estudiantes trabajar√°n en la redacci√≥n de la justificaci√≥n de su proyecto, enfoc√°ndose en convencer de su relevancia. Ejercicios de "elevator pitch" para sus ideas.</li>
                                <li>**"Presentaci√≥n Preliminar del Mapa" (60 min):** Cada estudiante (o pareja) realizar√° una presentaci√≥n breve (5-7 min) de los avances de su propuesta de investigaci√≥n (problema, pregunta, objetivos, justificaci√≥n preliminar, posible alcance). Se fomentar√° la retroalimentaci√≥n constructiva entre compa√±eros.</li>
                            </ul>
                            <p className="font-semibold mt-4">Tarea (Desaf√≠o Post-Clase):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Borrador del Explorador":** Consolidar el primer borrador completo de la propuesta de investigaci√≥n, incluyendo todas las secciones discutidas: Introducci√≥n, Planteamiento del Problema, Justificaci√≥n, Objetivos, un Marco Conceptual preliminar y un esquema de la Metodolog√≠a.</li>
                            </ul>
                        </>
                    ),
                    isUnlockable: false
                },
                {
                    week: 7,
                    title: 'Parcial 1 - El Primer Hito: Presentaci√≥n de la Propuesta de Investigaci√≥n (Avance)',
                    badge: 'Badge de Navegante Experto',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>Evaluaci√≥n formal de los avances en la formulaci√≥n de la propuesta de investigaci√≥n.</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"Defensa del Mapa" (120 min):** Exposiciones individuales (o en pareja) formales de la propuesta de investigaci√≥n. Cada estudiante tendr√° un tiempo asignado para presentar y luego responder preguntas del profesor y compa√±eros.</li>
                            </ul>
                            <p className="font-semibold mt-4">Tarea (Desaf√≠o Post-Clase):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"Refinando el Mapa":** Incorporar la retroalimentaci√≥n recibida durante el parcial para refinar y fortalecer la propuesta de investigaci√≥n. Este documento ser√° la base para las siguientes unidades.</li>
                            </ul>
                            <p className="font-semibold mt-4">R√∫brica Parcial 1: Propuesta de Investigaci√≥n (30% de la nota final)</p>
                            <div className="overflow-x-auto">
                                <table className="min-w-full bg-white border border-gray-200">
                                    <thead>
                                        <tr className="bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            <th className="py-3 px-4 border-b">Criterio</th>
                                            <th className="py-3 px-4 border-b">Excelente (5)</th>
                                            <th className="py-3 px-4 border-b">Bueno (4)</th>
                                            <th className="py-3 px-4 border-b">Regular (3)</th>
                                            <th className="py-3 px-4 border-b">Insuficiente (2)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr><td className="py-2 px-4 border-b">Planteamiento del Problema</td><td className="py-2 px-4 border-b">El problema est√° claramente definido, contextualizado, su relevancia es convincente y se vincula al dise√±o/innovaci√≥n.</td><td className="py-2 px-4 border-b">El problema est√° definido y contextualizado, pero la relevancia podr√≠a ser m√°s fuerte o la conexi√≥n con el dise√±o menos expl√≠cita.</td><td className="py-2 px-4 border-b">El problema es identificable, pero le falta claridad, contextualizaci√≥n y/o una conexi√≥n clara con el campo de estudio.</td><td className="py-2 px-4 border-b">El problema no est√° claro, no es relevante o no se relaciona con las disciplinas del curso.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">Pregunta de Investigaci√≥n</td><td className="py-2 px-4 border-b">La pregunta es clara, concisa, espec√≠fica, medible, directamente relacionada con el problema y orienta la investigaci√≥n.</td><td className="py-2 px-4 border-b">La pregunta es clara y relevante, pero podr√≠a ser m√°s espec√≠fica, medible o menos orientadora para la investigaci√≥n.</td><td className="py-2 px-4 border-b">La pregunta es vaga, ambigua o no se alinea completamente con el problema planteado.</td><td className="py-2 px-4 border-b">La pregunta es confusa, inexistente o no es una pregunta de investigaci√≥n.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">Objetivos de Investigaci√≥n</td><td className="py-2 px-4 border-b">Los objetivos generales y espec√≠ficos son SMART, coherentes con la pregunta y abordan el problema de forma integral.</td><td className="py-2 px-4 border-b">Los objetivos son claros, pero algunos podr√≠an ser m√°s espec√≠ficos, medibles o no cubren completamente el alcance del problema.</td><td className="py-2 px-4 border-b">Los objetivos son generales, poco claros y/o no est√°n completamente alineados con la pregunta de investigaci√≥n.</td><td className="py-2 px-4 border-b">Los objetivos son inexistentes, incoherentes o no tienen relaci√≥n con la investigaci√≥n propuesta.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">Justificaci√≥n</td><td className="py-2 px-4 border-b">Demuestra una comprensi√≥n profunda de la relevancia del estudio, su contribuci√≥n te√≥rica, pr√°ctica y social.</td><td className="py-2 px-4 border-b">La justificaci√≥n es adecuada, pero podr√≠a profundizar en la contribuci√≥n del estudio o en su impacto.</td><td className="py-2 px-4 border-b">La justificaci√≥n es superficial, no logra convencer de la importancia del estudio o es poco argumentada.</td><td className="py-2 px-4 border-b">No hay justificaci√≥n o la presentada es irrelevante, incorrecta o sin sustento.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">Estructura y Coherencia</td><td className="py-2 px-4 border-b">La propuesta est√° l√≥gicamente estructurada, con una excelente coherencia y fluidez entre todos sus componentes.</td><td className="py-2 px-4 border-b">La propuesta est√° bien estructurada, con buena coherencia entre sus partes, aunque con transiciones ocasionales mejorables.</td><td className="py-2 px-4 border-b">La estructura es b√°sica y la coherencia entre los componentes es d√©bil o inconsistente.</td><td className="py-2 px-4 border-b">La propuesta carece de estructura, es desorganizada o incoherente en sus partes.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">Presentaci√≥n Oral</td><td className="py-2 px-4 border-b">Presentaci√≥n clara, concisa, segura, con dominio del tema, excelente manejo del tiempo y respuesta efectiva a preguntas.</td><td className="py-2 px-4 border-b">Presentaci√≥n clara y con buen dominio del tema, aunque podr√≠a mejorar el manejo del tiempo o la interacci√≥n con preguntas.</td><td className="py-2 px-4 border-b">Presentaci√≥n con poca claridad, dominio limitado del tema y/o problemas de tiempo.</td><td className="py-2 px-4 border-b">Presentaci√≥n confusa, sin dominio del tema, incompleta o incapacidad para responder preguntas.</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </>
                    ),
                    isUnlockable: false
                },
                {
                    week: 8,
                    title: 'Misi√≥n de Dise√±o - Creando tu Estrategia de Recolecci√≥n',
                    badge: 'Badge de Estratega Metodol√≥gico',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>Dise√±o metodol√≥gico: Selecci√≥n del tipo de estudio (exploratorio, descriptivo, correlacional, explicativo).</li>
                                <li>Poblaci√≥n y muestra: Definici√≥n de los participantes del estudio, criterios de inclusi√≥n y exclusi√≥n, m√©todos de muestreo (probabil√≠stico y no probabil√≠stico).</li>
                                <li>Definici√≥n de conceptos clave (marco conceptual): Operacionalizaci√≥n de variables y categor√≠as de an√°lisis.</li>
                                <li>Consideraciones sobre la validez y fiabilidad en la recolecci√≥n de datos.</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Laboratorio Metodol√≥gico" (90 min):** En grupos, los estudiantes trabajar√°n en el dise√±o detallado de la metodolog√≠a para su proyecto. Deber√°n definir el tipo de estudio, la poblaci√≥n, el tama√±o y tipo de muestra, y c√≥mo operacionalizar√°n sus conceptos clave. El profesor proporcionar√° ejemplos y guiar√° la discusi√≥n.</li>
                                <li>**"Debate: ¬øCu√°ntos y Qui√©nes?" (30 min):** Discusi√≥n sobre los desaf√≠os de definir la poblaci√≥n y muestra en proyectos de dise√±o (ej. estudios con usuarios, pruebas de usabilidad).</li>
                            </ul>
                            <p className="font-semibold mt-4">Tarea (Desaf√≠o Post-Clase):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Arsenal del Investigador":** Profundizar en el marco conceptual, definiendo claramente los conceptos principales de su investigaci√≥n.</li>
                                <li>**"Esquema Metodol√≥gico Detallado":** Desarrollar el esquema de su metodolog√≠a, incluyendo: tipo de estudio, poblaci√≥n objetivo, criterios de selecci√≥n de la muestra, y una primera idea de las t√©cnicas de recolecci√≥n de datos que utilizar√°n.</li>
                            </ul>
                        </>
                    ),
                    isUnlockable: false
                },
                {
                    week: 9,
                    title: 'Misi√≥n de Herramientas - Construyendo tus Instrumentos',
                    badge: 'Badge de Constructor de Instrumentos',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>T√©cnicas e instrumentos de recolecci√≥n de datos cualitativos: Entrevistas (estructuradas, semi-estructuradas, no estructuradas), grupos focales, observaci√≥n (participante, no participante), diarios de campo, an√°lisis de contenido.</li>
                                <li>T√©cnicas e instrumentos de recolecci√≥n de datos cuantitativos: Encuestas (dise√±o de preguntas, escalas de medici√≥n), experimentos (variables, grupos de control), pruebas de usabilidad (m√©tricas).</li>
                                <li>Dise√±o de instrumentos: Redacci√≥n de preguntas, estructura, validaci√≥n (piloto).</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"Caja de Herramientas del Investigador: Taller de Dise√±o de Instrumentos" (90 min):** Los estudiantes, en sus grupos de proyecto, comenzar√°n a dise√±ar los borradores de sus instrumentos de recolecci√≥n de datos (ej. guion de entrevista, cuestionario de encuesta, protocolo de observaci√≥n para una prueba de usabilidad). Se realizar√°n ejercicios de "role-play" o pruebas r√°pidas entre compa√±eros para recibir retroalimentaci√≥n inicial.</li>
                                <li>**"Mini-Simulaci√≥n de Recolecci√≥n" (30 min):** Breve ejercicio pr√°ctico de aplicaci√≥n de un fragmento de instrumento (ej. una serie de 3 preguntas de entrevista o un mini-cuestionario) para experimentar el proceso.</li>
                            </ul>
                            <p className="font-semibold mt-4">Tarea (Desaf√≠o Post-Clase):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Kit de Recolecci√≥n":** Desarrollar los borradores completos de los instrumentos de recolecci√≥n de datos para su proyecto. Deben estar listos para una prueba piloto.</li>
                            </ul>
                        </>
                    ),
                    isUnlockable: false
                },
                {
                    week: 10,
                    title: 'Misi√≥n de Campo - Recolectando los Datos (¬°La Aventura Comienza!)',
                    badge: 'Badge de Recolector de Datos',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>Ejecuci√≥n de la recolecci√≥n de datos: Preparaci√≥n log√≠stica, gesti√≥n de participantes, √©tica en la pr√°ctica.</li>
                                <li>Organizaci√≥n de datos cualitativos: Transcripci√≥n de entrevistas, sistematizaci√≥n de observaciones.</li>
                                <li>Organizaci√≥n de datos cuantitativos: Creaci√≥n de bases de datos (hojas de c√°lculo), codificaci√≥n de respuestas.</li>
                                <li>Manejo de imprevistos durante la recolecci√≥n.</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"Expedici√≥n de Datos: Desaf√≠os y Soluciones" (60 min):** Discusi√≥n sobre los desaf√≠os comunes en la recolecci√≥n de datos (ej. baja participaci√≥n, sesgos, problemas t√©cnicos). Se presentar√°n casos de estudio y estrategias para superarlos.</li>
                                <li>**"Taller: Organizando el Tesoro" (60 min):** Los estudiantes trabajar√°n en la organizaci√≥n de una peque√±a muestra de datos (simulados o reales si ya han avanzado) en el formato adecuado para su an√°lisis (ej. tabla para datos cuantitativos, transcripci√≥n para cualitativos).</li>
                            </ul>
                            <p className="font-semibold mt-4">Tarea (Desaf√≠o Post-Clase):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Diario del Explorador":** Iniciar la recolecci√≥n de datos para el proyecto (si es factible y √©ticamente aprobado, con un grupo peque√±o de prueba; si no, simular la recolecci√≥n y organizar datos ficticios realistas). Documentar el proceso, los desaf√≠os encontrados y las decisiones tomadas.</li>
                                <li>**"Base de Datos Preliminar":** Organizar los datos recolectados (o simulados) en una estructura adecuada para el an√°lisis.</li>
                            </ul>
                        </>
                    ),
                    isUnlockable: false
                },
                {
                    week: 11,
                    title: 'Misi√≥n de Descifrado - An√°lisis Cualitativo',
                    badge: 'Badge de Int√©rprete Cualitativo',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>Introducci√≥n al an√°lisis de datos cualitativos: el proceso interpretativo.</li>
                                <li>T√©cnicas de an√°lisis cualitativo: Codificaci√≥n (abierta, axial, selectiva), an√°lisis tem√°tico, an√°lisis de contenido, an√°lisis de discurso.</li>
                                <li>Herramientas para el an√°lisis cualitativo (menci√≥n de software como Atlas.ti, NVivo, o m√©todos manuales con hojas de c√°lculo).</li>
                                <li>Interpretaci√≥n de resultados cualitativos: Construcci√≥n de narrativas y significados.</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Detective Cualitativo: Taller de Codificaci√≥n" (90 min):** Los estudiantes trabajar√°n con un fragmento de datos cualitativos (ej. transcripci√≥n de una entrevista simulada o real). Aplicar√°n t√©cnicas de codificaci√≥n abierta y axial para identificar categor√≠as y temas emergentes.</li>
                                <li>**"Discusi√≥n: Historias que los Datos Cuentan" (30 min):** Compartir los primeros temas identificados y discutir c√≥mo las narrativas cualitativas aportan a la comprensi√≥n del problema.</li>
                            </ul>
                            <p className="font-semibold mt-4">Tarea (Desaf√≠o Post-Clase):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"Primeros Hallazgos Cualitativos":** Realizar el an√°lisis preliminar de los datos cualitativos recolectados para su proyecto. Identificar al menos 3-5 temas o categor√≠as emergentes clave que respondan a su pregunta de investigaci√≥n.</li>
                            </ul>
                        </>
                    ),
                    isUnlockable: false
                },
                {
                    week: 12,
                    title: 'Misi√≥n de Cuantificaci√≥n - An√°lisis Cuantitativo',
                    badge: 'Badge de Analista Cuantitativo',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>Introducci√≥n al an√°lisis de datos cuantitativos: estad√≠sticas descriptivas (frecuencias, promedios, desviaci√≥n est√°ndar, moda, mediana).</li>
                                <li>Estad√≠sticas inferenciales b√°sicas (correlaci√≥n, comparaci√≥n de medias - conceptos generales).</li>
                                <li>Herramientas para el an√°lisis cuantitativo (Excel, Google Sheets, SPSS, R - menci√≥n de herramientas).</li>
                                <li>Interpretaci√≥n de resultados cuantitativos: Identificaci√≥n de patrones, tendencias y relaciones.</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Mago de los N√∫meros: Taller de An√°lisis Descriptivo" (90 min):** Los estudiantes trabajar√°n con una peque√±a base de datos cuantitativos (simulados o reales). Calcular√°n estad√≠sticas descriptivas y generar√°n gr√°ficos b√°sicos (barras, torta, l√≠neas) para visualizar sus datos.</li>
                                <li>**"Debate: ¬øQu√© Nos Dicen los N√∫meros?" (30 min):** Discusi√≥n sobre c√≥mo los datos cuantitativos complementan o contrastan con los cualitativos en la investigaci√≥n en dise√±o.</li>
                            </ul>
                            <p className="font-semibold mt-4">Tarea (Desaf√≠o Post-Clase):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"Primeros Hallazgos Cuantitativos":** Realizar el an√°lisis preliminar de los datos cuantitativos recolectados para su proyecto. Generar al menos 3-5 gr√°ficos o tablas que muestren sus hallazgos m√°s interesantes y relevantes para su pregunta de investigaci√≥n.</li>
                            </ul>
                        </>
                    ),
                    isUnlockable: false
                },
                {
                    week: 13,
                    title: 'Parcial 2 - El Segundo Hito: Presentaci√≥n de Resultados de An√°lisis Preliminar',
                    badge: 'Badge de Descubridor de Patrones',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>Evaluaci√≥n formal de la capacidad para analizar datos cualitativos y cuantitativos, y de la interpretaci√≥n inicial de los resultados.</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Relato de los Datos" (120 min):** Cada estudiante (o pareja) presentar√° los an√°lisis preliminares de sus datos (cualitativos y/o cuantitativos). Deber√°n mostrar sus hallazgos m√°s relevantes, explicar c√≥mo los analizaron y discutir las primeras interpretaciones y las conexiones con su pregunta de investigaci√≥n.</li>
                            </ul>
                            <p className="font-semibold mt-4">Tarea (Desaf√≠o Post-Clase):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"Las Primeras Conclusiones":** Elaborar conclusiones argumentadas basadas en los resultados preliminares, conect√°ndolas con los objetivos de investigaci√≥n y la pregunta planteada. Identificar nuevas preguntas o √°reas de profundizaci√≥n.</li>
                            </ul>
                            <p className="font-semibold mt-4">R√∫brica Parcial 2: An√°lisis Preliminar de Datos (30% de la nota final)</p>
                            <div className="overflow-x-auto">
                                <table className="min-w-full bg-white border border-gray-200">
                                    <thead>
                                        <tr className="bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            <th className="py-3 px-4 border-b">Criterio</th>
                                            <th className="py-3 px-4 border-b">Excelente (5)</th>
                                            <th className="py-3 px-4 border-b">Bueno (4)</th>
                                            <th className="py-3 px-4 border-b">Regular (3)</th>
                                            <th className="py-3 px-4 border-b">Insuficiente (2)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr><td className="py-2 px-4 border-b">Organizaci√≥n y Preparaci√≥n de Datos</td><td className="py-2 px-4 border-b">Datos cualitativos y cuantitativos organizados de forma impecable, l√≥gica y listos para el an√°lisis.</td><td className="py-2 px-4 border-b">Datos bien organizados, con algunas √°reas menores de mejora en la estructura o preparaci√≥n.</td><td className="py-2 px-4 border-b">Datos con organizaci√≥n b√°sica, pero con inconsistencias o dificultades para el an√°lisis efectivo.</td><td className="py-2 px-4 border-b">Datos desorganizados, incompletos o incorrectos, imposibilitando el an√°lisis.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">An√°lisis Cualitativo (si aplica)</td><td className="py-2 px-4 border-b">Aplicaci√≥n rigurosa y correcta de t√©cnicas de codificaci√≥n y an√°lisis tem√°tico, identificando patrones y significados profundos.</td><td className="py-2 px-4 border-b">Buen an√°lisis cualitativo, identificando temas relevantes, aunque podr√≠a profundizar en la interpretaci√≥n o la conexi√≥n entre c√≥digos.</td><td className="py-2 px-4 border-b">An√°lisis cualitativo superficial, con temas poco desarrollados, c√≥digos inconsistentes o conexiones d√©biles.</td><td className="py-2 px-4 border-b">No se realiz√≥ an√°lisis cualitativo, es incorrecto o no se basa en los datos.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">An√°lisis Cuantitativo (si aplica)</td><td className="py-2 px-4 border-b">Aplicaci√≥n correcta de t√©cnicas descriptivas e inferenciales b√°sicas, con interpretaci√≥n clara y precisa de los resultados.</td><td className="py-2 px-4 border-b">Buen an√°lisis cuantitativo, con resultados claros, aunque la interpretaci√≥n podr√≠a ser m√°s profunda o las t√©cnicas m√°s variadas.</td><td className="py-2 px-4 border-b">An√°lisis cuantitativo b√°sico, con errores en la aplicaci√≥n de t√©cnicas o interpretaci√≥n limitada/incorrecta.</td><td className="py-2 px-4 border-b">No se realiz√≥ an√°lisis cuantitativo, es incorrecto o no se basa en los datos.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">Conexi√≥n con Objetivos y Pregunta</td><td className="py-2 px-4 border-b">Los an√°lisis est√°n directamente vinculados con los objetivos de investigaci√≥n, respondiendo de forma clara a la pregunta planteada.</td><td className="py-2 px-4 border-b">Los an√°lisis se relacionan con los objetivos, pero la conexi√≥n podr√≠a ser m√°s expl√≠cita o directa con la pregunta.</td><td className="py-2 px-4 border-b">La conexi√≥n entre los an√°lisis y los objetivos/pregunta es d√©bil, inconsistente o poco clara.</td><td className="py-2 px-4 border-b">Los an√°lisis no tienen relaci√≥n con los objetivos o la pregunta de investigaci√≥n.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">Interpretaci√≥n y Conclusiones Preliminares</td><td className="py-2 px-4 border-b">Interpretaciones profundas, cr√≠ticas y conclusiones preliminares argumentadas, basadas s√≥lidamente en la evidencia de los datos.</td><td className="py-2 px-4 border-b">Interpretaciones adecuadas y conclusiones preliminares, aunque podr√≠an ser m√°s robustas o menos superficiales.</td><td className="py-2 px-4 border-b">Interpretaciones superficiales y conclusiones poco argumentadas, sin sustento claro en los datos o con inferencias incorrectas.</td><td className="py-2 px-4 border-b">No hay interpretaciones o conclusiones, o son incorrectas/irrelevantes.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">Presentaci√≥n Oral</td><td className="py-2 px-4 border-b">Presentaci√≥n clara, concisa, con visualizaci√≥n efectiva de resultados, dominio del tema y excelente manejo del tiempo.</td><td className="py-2 px-4 border-b">Presentaci√≥n clara, con buena visualizaci√≥n, aunque podr√≠a mejorar el manejo del tiempo o la fluidez.</td><td className="py-2 px-4 border-b">Presentaci√≥n con poca claridad, visualizaci√≥n deficiente de resultados y/o problemas de tiempo.</td><td className="py-2 px-4 border-b">Presentaci√≥n confusa, sin resultados claros o incompleta.</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </>
                    ),
                    isUnlockable: false
                },
                {
                    week: 14,
                    title: 'Misi√≥n de Narrativa - Contando tu Historia con Datos',
                    badge: 'Badge de Narrador Visual',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>Principios de visualizaci√≥n de datos: Claridad, precisi√≥n, integridad, est√©tica. Tipos de gr√°ficos adecuados para diferentes tipos de datos y mensajes.</li>
                                <li>Herramientas de visualizaci√≥n (Chart.js, Plotly.js - conceptos b√°sicos).</li>
                                <li>Estructura del informe final de investigaci√≥n: Introducci√≥n, Marco Te√≥rico, Metodolog√≠a, Resultados, Discusi√≥n, Conclusiones, Recomendaciones, Referencias.</li>
                                <li>Redacci√≥n acad√©mica y estilo.</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Artista de Datos: Taller de Visualizaci√≥n" (90 min):** Los estudiantes trabajar√°n en la creaci√≥n de visualizaciones impactantes para sus resultados (ej. infograf√≠as, gr√°ficos avanzados). Se revisar√°n ejemplos de buenas y malas pr√°cticas en visualizaci√≥n.</li>
                                <li>**"Construyendo el Esqueleto del Informe" (30 min):** Discusi√≥n sobre la estructura del informe final, asignando secciones y responsabilidades (si es un trabajo en equipo).</li>
                            </ul>
                            <p className="font-semibold mt-4">Tarea (Desaf√≠o Post-Clase):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Primer Cap√≠tulo":** Empezar a redactar el informe final de investigaci√≥n, prestando especial atenci√≥n a la secci√≥n de Resultados. Asegurarse de que los hallazgos est√©n bien presentados y explicados, con el apoyo de las visualizaciones creadas.</li>
                            </ul>
                        </>
                    ),
                    isUnlockable: false
                },
                {
                    week: 15,
                    title: 'Misi√≥n de Impacto - Preparando tu Gran Revelaci√≥n',
                    badge: 'Badge de Comunicador Maestro',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>Comunicaci√≥n efectiva de resultados de investigaci√≥n: Adaptaci√≥n del mensaje a la audiencia, claridad y concisi√≥n.</li>
                                <li>Dise√±o de presentaciones orales: Estructura, ayudas visuales, manejo del tiempo, t√©cnicas de oratoria.</li>
                                <li>Consideraciones √©ticas en la comunicaci√≥n de resultados: No distorsionar datos, reconocer limitaciones, citar fuentes.</li>
                                <li>Preparaci√≥n para la defensa del proyecto.</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"El Escenario del Investigador: Ensayo General" (120 min):** Cada estudiante (o pareja) realizar√° un ensayo de su presentaci√≥n oral del proyecto final. Se cronometrar√° el tiempo y se proporcionar√° retroalimentaci√≥n detallada sobre el contenido, la claridad, las ayudas visuales y la oratoria.</li>
                            </ul>
                            <p className="font-semibold mt-4">Tarea (Desaf√≠o Post-Clase):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"La Obra Maestra":** Finalizar el informe de investigaci√≥n, asegurando que todos los componentes est√©n completos, pulidos y coherentes.</li>
                                <li>**"El Discurso Final":** Preparar la presentaci√≥n oral final, ensayando hasta dominar el contenido y el tiempo.</li>
                            </ul>
                        </>
                    ),
                    isUnlockable: false
                },
                {
                    week: 16,
                    title: 'Parcial 3 - La Gran Final: Entrega Final de Proyecto Aplicado',
                    badge: 'Badge de Investigador √âlite',
                    content: (
                        <>
                            <p className="font-semibold">Contenido:</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>Presentaci√≥n y defensa formal del proyecto de investigaci√≥n aplicado.</li>
                            </ul>
                            <p className="font-semibold mt-4">Actividad en Clase (2 horas):</p>
                            <ul className="list-disc list-inside ml-4">
                                <li>**"La Defensa del Proyecto" (120 min):** Presentaci√≥n y defensa de los proyectos finales de investigaci√≥n ante el profesor y compa√±eros. Cada equipo/estudiante tendr√° un tiempo asignado para su presentaci√≥n y una sesi√≥n de preguntas y respuestas.</li>
                            </ul>
                            <p className="font-semibold mt-4">R√∫brica Parcial 3: Entrega Final de Proyecto Aplicado (40% de la nota final)</p>
                            <div className="overflow-x-auto">
                                <table className="min-w-full bg-white border border-gray-200">
                                    <thead>
                                        <tr className="bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            <th className="py-3 px-4 border-b">Criterio</th>
                                            <th className="py-3 px-4 border-b">Excelente (5)</th>
                                            <th className="py-3 px-4 border-b">Bueno (4)</th>
                                            <th className="py-3 px-4 border-b">Regular (3)</th>
                                            <th className="py-3 px-4 border-b">Insuficiente (2)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr><td className="py-2 px-4 border-b">Calidad del Informe Final</td><td className="py-2 px-4 border-b">Informe completo, bien estructurado, claro, conciso, con redacci√≥n impecable, formato profesional y referencias adecuadas.</td><td className="py-2 px-4 border-b">Informe completo y estructurado, con buena redacci√≥n, aunque con algunos detalles menores a pulir en formato o estilo.</td><td className="py-2 px-4 border-b">Informe con algunas secciones incompletas o poco claras, y/o con errores de redacci√≥n/formato significativos.</td><td className="py-2 px-4 border-b">Informe incompleto, desorganizado, con graves deficiencias de redacci√≥n o formato, o sin referencias.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">Coherencia y Argumentaci√≥n del Proyecto</td><td className="py-2 px-4 border-b">Coherencia total y expl√≠cita entre problema, objetivos, marco te√≥rico, metodolog√≠a, resultados y conclusiones. Argumentaci√≥n s√≥lida y basada en evidencia.</td><td className="py-2 px-4 border-b">Buena coherencia y argumentaci√≥n, aunque algunos puntos podr√≠an ser m√°s robustos o la conexi√≥n m√°s expl√≠cita.</td><td className="py-2 px-4 border-b">Coherencia limitada entre los componentes y/o argumentaci√≥n d√©bil, con algunas inconsistencias.</td><td className="py-2 px-4 border-b">Falta de coherencia y argumentaci√≥n, o argumentos sin sustento en la investigaci√≥n.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">An√°lisis y Presentaci√≥n de Resultados</td><td className="py-2 px-4 border-b">An√°lisis exhaustivo y profundo de datos cualitativos y cuantitativos. Presentaci√≥n clara, efectiva y visualmente impactante de resultados.</td><td className="py-2 px-4 border-b">An√°lisis adecuado y presentaci√≥n clara de resultados, con visualizaciones funcionales y comprensibles.</td><td className="py-2 px-4 border-b">An√°lisis superficial o incompleto. Resultados presentados de forma confusa o con visualizaciones deficientes/incorrectas.</td><td className="py-2 px-4 border-b">No hay an√°lisis de datos o los resultados son incomprensibles, irrelevantes o no presentados.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">Discusi√≥n y Conclusiones</td><td className="py-2 px-4 border-b">Discusi√≥n cr√≠tica de los hallazgos, conect√°ndolos con la literatura y el contexto. Conclusiones claras, concisas, con implicaciones pr√°cticas/te√≥ricas y recomendaciones.</td><td className="py-2 px-4 border-b">Discusi√≥n y conclusiones adecuadas, aunque podr√≠an ser m√°s profundas, cr√≠ticas o tener mayores implicaciones.</td><td className="py-2 px-4 border-b">Discusi√≥n superficial o conclusiones vagas, sin conexi√≥n clara con los hallazgos o sin recomendaciones pertinentes.</td><td className="py-2 px-4 border-b">No hay discusi√≥n o conclusiones, o son incorrectas/irrelevantes.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">Contribuci√≥n al Campo</td><td className="py-2 px-4 border-b">El proyecto demuestra una contribuci√≥n significativa, original y relevante a la comprensi√≥n de problem√°ticas en dise√±o, innovaci√≥n o UX.</td><td className="py-2 px-4 border-b">El proyecto realiza una contribuci√≥n relevante al campo, aunque no necesariamente original o con un impacto limitado.</td><td className="py-2 px-4 border-b">La contribuci√≥n del proyecto es limitada, poco clara o no se alinea bien con las disciplinas del curso.</td><td className="py-2 px-4 border-b">El proyecto no demuestra una contribuci√≥n al campo o es irrelevante.</td></tr>
                                        <tr><td className="py-2 px-4 border-b">Presentaci√≥n Oral y Defensa</td><td className="py-2 px-4 border-b">Presentaci√≥n excepcional, dominio total del tema, capacidad para responder preguntas de forma cr√≠tica, reflexiva y persuasiva.</td><td className="py-2 px-4 border-b">Presentaci√≥n muy buena, buen dominio del tema y capacidad para responder la mayor√≠a de las preguntas de forma adecuada.</td><td className="py-2 px-4 border-b">Presentaci√≥n con debilidades (claridad, tiempo, visuales), dominio limitado del tema y dificultades para responder preguntas.</td><td className="py-2 px-4 border-b">Presentaci√≥n deficiente, sin dominio del tema, incompleta o incapacidad para defender el proyecto.</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </>
                    ),
                    isUnlockable: false
                }
            ];

            if (loadingUserData) {
                return <LoadingSpinner />;
            }

            if (error) {
                return (
                    <div className="min-h-screen flex items-center justify-center" style={{backgroundColor: 'var(--bg-primary)'}}>
                        <div className="card rounded-xl p-8 text-center animate-fadeIn">
                            <p style={{color: 'var(--error-color)'}} className="text-lg font-semibold">{error}</p>
                            <button 
                                onClick={() => window.location.reload()} 
                                className="btn btn-primary mt-4"
                            >
                                Reintentar
                            </button>
                        </div>
                    </div>
                );
            }

            const studentName = userData?.fullName || currentUser?.email.split('@')[0];
            const studentEmailDisplay = userData?.email || currentUser?.email;
            const earnedBadges = userData?.badgesEarned || [];
            const completedWeeks = earnedBadges.length;

            return (
                <div className="min-h-screen p-4 md:p-8" style={{backgroundColor: 'var(--bg-primary)'}}>
                    <header className="card rounded-xl p-6 mb-8 animate-fadeIn">
                        <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                            <div className="flex-1">
                                <h1 className="text-3xl font-bold mb-2" style={{color: 'var(--text-primary)'}}>
                                    Seminario de Investigaci√≥n
                                </h1>
                                <div className="flex items-center gap-2 text-sm" style={{color: 'var(--text-secondary)'}}>
                                    <User />
                                    <span>Hola, <strong>{studentName}</strong> ({studentEmailDisplay})</span>
                                </div>
                                <div className="mt-3">
                                    <ProgressBar current={completedWeeks} total={courseWeeks.length} />
                                </div>
                            </div>
                            <div className="flex items-center gap-3">
                                <ThemeToggle />
                                <button
                                    onClick={handleLogout}
                                    className="btn btn-secondary flex items-center gap-2"
                                    title="Cerrar sesi√≥n"
                                >
                                    <LogOut />
                                    <span className="hidden md:inline">Cerrar Sesi√≥n</span>
                                </button>
                            </div>
                        </div>
                    </header>

                    <main className="container mx-auto max-w-6xl">
                        <BadgesDashboard 
                            courseWeeks={courseWeeks} 
                            userData={userData} 
                            onEarnBadge={earnBadge}
                        />
                        
                        <div className="mb-8">
                            <h2 className="text-3xl font-bold text-center mb-2" style={{color: 'var(--text-primary)'}}>
                                Tu Aventura Semanal
                            </h2>
                            <p className="text-center" style={{color: 'var(--text-secondary)'}}>
                                Completa cada semana para desbloquear la siguiente y obtener badges
                            </p>
                        </div>
                        
                        <div className="space-y-6">
                            {courseWeeks.map((weekData, index) => {
                                const previousBadge = index > 0 ? courseWeeks[index - 1].badge : null;
                                const isUnlocked = weekData.week === 1 || hasBadge(previousBadge);
                                const hasCurrentBadge = hasBadge(weekData.badge);

                                return (
                                    <CourseWeek
                                        key={weekData.week}
                                        weekNumber={weekData.week}
                                        title={weekData.title}
                                        content={weekData.content}
                                        badgeName={weekData.badge}
                                        isUnlocked={isUnlocked}
                                        hasBadge={hasCurrentBadge}
                                    />
                                );
                            })}
                        </div>
                    </main>
                </div>
            );
        }

        // Componente principal de la aplicaci√≥n React
        function App() {
            const [firebaseApp, setFirebaseApp] = React.useState(null);
            const [auth, setAuth] = React.useState(null);
            const [currentUser, setCurrentUser] = React.useState(null);
            const [userData, setUserData] = React.useState(null);
            const [authReady, setAuthReady] = React.useState(false);
            const [firebaseConfigLoaded, setFirebaseConfigLoaded] = React.useState(false);
            const [userDataLoaded, setUserDataLoaded] = React.useState(false);

            // Configuraci√≥n de Firebase desde variables de entorno o archivo externo
            const firebaseConfig = window.FIREBASE_CONFIG || {
                // Configuraci√≥n por defecto vac√≠a - debe ser configurada externamente
                apiKey: "",
                authDomain: "",
                projectId: "",
                storageBucket: "",
                messagingSenderId: "",
                appId: ""
            };

            React.useEffect(() => {
                if (firebaseConfig.apiKey && !firebaseApp) {
                    console.log('Inicializando Firebase...');
                    const app = firebase.initializeApp(firebaseConfig);
                    setFirebaseApp(app);
                    const authInstance = firebase.auth();
                    setAuth(authInstance);
                    setFirebaseConfigLoaded(true);
                } else if (!firebaseConfig.apiKey) {
                    console.error("Firebase config no est√° completa. Por favor, rellena los placeholders.");
                    setAuthReady(true);
                }
            }, [firebaseApp, firebaseConfig.apiKey]);
            
            // useEffect separado para el listener de autenticaci√≥n
            React.useEffect(() => {
                if (auth) {
                    console.log('Configurando listener de autenticaci√≥n...');
                    const unsubscribe = auth.onAuthStateChanged(async (user) => {
                        console.log('Estado de autenticaci√≥n cambi√≥:', user ? `Usuario logueado: ${user.uid}` : 'Usuario no logueado');
                        setCurrentUser(user);
                        
                        if (user) {
                            // Cargar datos del usuario para determinar el tipo
                            try {
                                const db = firebase.firestore();
                                const userDoc = await db.doc(`artifacts/seminario-investigacion-app/users/${user.uid}`).get();
                                if (userDoc.exists) {
                                    setUserData(userDoc.data());
                                } else {
                                    setUserData(null);
                                }
                            } catch (error) {
                                console.error('Error cargando datos del usuario:', error);
                                setUserData(null);
                            }
                        } else {
                            setUserData(null);
                        }
                        
                        setUserDataLoaded(true);
                        setAuthReady(true);
                    });
                    
                    return () => {
                        console.log('Limpiando listener de autenticaci√≥n');
                        unsubscribe();
                    };
                }
            }, [auth]);

            if (!firebaseConfigLoaded || !authReady || (currentUser && !userDataLoaded)) {
                return <LoadingSpinner />;
            }

            console.log('Estado actual - currentUser:', currentUser ? 'Logueado' : 'No logueado');
            console.log('Tipo de usuario:', userData?.userType || 'No definido');

            return (
                <ToastProvider>
                    <AuthContext.Provider value={{ firebaseApp, currentUser, userData }}>
                        {currentUser ? (
                            userData?.userType === 'professor' ? (
                                <AdminDashboard currentUser={currentUser} />
                            ) : (
                                <CoursePage firebaseApp={firebaseApp} currentUser={currentUser} />
                            )
                        ) : (
                            <AuthPage firebaseApp={firebaseApp} />
                        )}
                    </AuthContext.Provider>
                </ToastProvider>
            );
        }

        // Montar la aplicaci√≥n React en el div con id "root" usando React 18
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
